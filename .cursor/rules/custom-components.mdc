---
description: Rules for building custom components (Path C)
globs:
  - src/components/**/*.tsx
  - src/components/**/*.scss
alwaysApply: false
---

# Custom Components (Path C)

Use when Base UI doesn't have the component.

## Before Building

1. Check Base UI repo: `curl -s "https://api.github.com/repos/mui/base-ui/contents/packages/react/src" | grep -i "name"`
2. Check for feature request: `curl -s "https://api.github.com/search/issues?q=repo:mui/base-ui+name"`
3. Study WAI-ARIA APG for the pattern
4. Look at a similar Base UI component for patterns

## Component Structure

```tsx
'use client';

import * as React from 'react';
import clsx from 'clsx';
import styles from './Component.module.scss';

export interface ComponentProps extends React.ComponentPropsWithoutRef<'div'> {
  children?: React.ReactNode;
}

export const Component = React.forwardRef<HTMLDivElement, ComponentProps>(
  function Component(props, forwardedRef) {
    const { className, children, ...elementProps } = props;

    return (
      <div
        ref={forwardedRef}
        className={clsx(styles.root, className)}
        {...elementProps}
      >
        {children}
      </div>
    );
  }
);

if (process.env.NODE_ENV !== 'production') {
  Component.displayName = 'Component';
}
```

## Compound Components

Use context for state sharing:

```tsx
const ComponentContext = React.createContext<State | undefined>(undefined);

function useComponentContext() {
  const context = React.useContext(ComponentContext);
  if (context === undefined) {
    throw new Error('Component parts must be placed within <Component.Root>.');
  }
  return context;
}
```

## Data Attributes (not classes)

```tsx
// State â†’ data attributes
<div data-checked={checked || undefined} data-disabled={disabled || undefined} />
```

```scss
// Style with attribute selectors
.root {
  &[data-checked] { /* checked styles */ }
  &[data-disabled] { /* disabled styles */ }
}
```

## Testing

Playwright CT is sufficient for most custom components.

Add unit tests (Vitest) only when there's complex logic:
- State machines
- Date/time calculations
- Filtering/sorting algorithms

## Checklist

- [ ] WAI-ARIA pattern followed
- [ ] forwardRef with named function
- [ ] Props spread last
- [ ] data-* attributes for state
- [ ] Context throws helpful error
- [ ] displayName in dev only
- [ ] Playwright tests pass
