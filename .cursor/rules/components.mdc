---
description: Component implementation rules
globs:
  - src/components/**/*.tsx
  - src/components/**/*.scss
alwaysApply: false
---

# Component Implementation

## Decision Tree

1. **Does Base UI have it?** → Wrap it (Path A/B)
2. **No Base UI equivalent?** → Build custom (Path C)

## Before Writing Code

1. Fetch Figma CSS via MCP `get_design_context` (fallback: `npm run figma:node`)
2. Check Base UI for existing component or composable primitives
3. For custom: check WAI-ARIA APG for accessibility requirements

## Rules

- Zero hardcoded values — use tokens from `_variables.scss`
- Use `@include` mixins from `_text-styles.scss` for typography
- Use `clsx` for className merging
- Use `forwardRef` with named function (not arrow)
- Use slots (`React.ReactNode` props) for nested elements
- Props spread last (consumer wins)

## Testing

| Path | Tests |
|------|-------|
| A/B (wrapper) | Playwright CT only |
| C (custom) | Playwright CT (unit tests only if complex logic) |

Run: `npm run test`

## File Structure

```
src/components/{Name}/
├── {Name}.tsx or parts.tsx
├── {Name}.module.scss
├── {Name}.test.tsx
├── {Name}.stories.tsx
└── index.ts
```

## Checklist

- [ ] Figma CSS fetched
- [ ] All values tokenized
- [ ] forwardRef + clsx
- [ ] Reduced motion: `@media (prefers-reduced-motion: reduce)`
- [ ] Tests pass
- [ ] Storybook story added
